from trueskill import Rating, rate_1vs1, global_env, TrueSkill
names = locals()

data = [(2,1),(2,1),(2,1),(4,3),(4,3),(4,3),(4,3),(5,6),(6,5),(6,5),(8,7),(7,8),(7,8),(7,8),(9,10),(9,10),(9,10),(10,9),(10,9),(11,12),(12,11),(12,11),(12,11),
        (2,5),(2,5),(2,5),(11,8),(11,8),(11,8),(11,8),(1,3),(1,3),(1,3),(3,1),(7,9),(7,9),(7,9),(7,9),(12,10),(12,10),(12,10),(10,12),(6,4),(6,4),(6,4),(6,4),
        # First Stage % First Week
        (1,9),(9,1),(9,1),(6,8),(6,8),(6,8),(6,8),(10,3),(10,3),(10,3),(10,3),(10,5),(10,5),(10,5),(10,5),(12,2),(12,2),(12,2),(9,4),(9,4),(4,9),(4,9),(4,9),
        (6,11),(6,11),(6,11),(6,11),(8,3),(8,3),(8,3),(8,3),(7,5),(7,5),(7,5),(5,7),(2,7),(2,7),(7,2),(7,2),(7,2),(12,4),(12,4),(12,4),(11,1),(11,1),(1,11),(1,11),(1,11),
        # First Stage % Second Week
        (1,7),(7,1),(7,1),(7,1),(3,6),(6,3),(6,3),(6,3),(4,2),(4,2),(2,4),(2,4),(2,4),(11,7),(11,7),(11,7),(7,11),(7,11),(9,12),(9,12),(9,12),(12,9),(12,9),(10,8),(10,8),(10,8),(10,8),
        (6,12),(6,12),(12,6),(12,6),(12,6),(3,9),(3,9),(9,3),(9,3),(9,3),(5,1),(5,1),(5,1),(5,11),(5,11),(11,5),(11,5),(11,5),(2,8),(2,8),(2,8),(8,2),(10,4),(10,4),(10,4),(10,4),
        # First Stage % Third Week
        (2,9),(2,9),(2,9),(2,9),(8,4),(4,8),(4,8),(4,8),(10,1),(10,1),(10,1),(1,10),(9,5),(9,5),(9,5),(9,5),(12,3),(12,3),(12,3),(12,3),(7,6),(7,6),(7,6),(7,6),
        (1,8),(1,8),(1,8),(1,8),(6,10),(6,10),(6,10),(10,6),(10,6),(11,4),(11,4),(11,4),(11,4),(7,3),(7,3),(7,3),(7,3),(5,12),(12,5),(12,5),(12,5),(11,2),(11,2),(11,2),(11,2),
        # First Stage % Fourth Week
        (3,5),(3,5),(5,3),(5,3),(5,3),(1,4),(4,1),(4,1),(4,1),(2,6),(2,6),(2,6),(11,9),(11,9),(11,9),(11,9),(12,8),(12,8),(12,8),(7,10),(10,7),(10,7),(10,7),
        (4,5),(5,4),(5,4),(5,4),(6,1),(6,1),(6,1),(1,6),(1,6),(2,3),(2,3),(2,3),(2,3),(12,7),(12,7),(12,7),(7,12),(7,12),(10,11),(10,11),(10,11),(11,10),(11,10),(8,9),(8,9),(9,8),(9,8),(9,8),
        # First Stage % Fifth Week
        (7,10),(7,10),(7,10),(10,7),(12,7),(12,7),(7,12),(7,12),(7,12),
        # Final Stage
        (6,2),(6,2),(6,2),(6,2),(5,3),(5,3),(5,3),(3,5),(4,1),(4,1),(4,1),(4,1),(10,7),(10,7),(10,7),(7,10),(7,10),(12,8),(12,8),(12,8),(8,12),(9,11),(9,11),(9,11),(9,11),
        (7,12),(7,12),(7,12),(12,7),(12,7),(5,4),(5,4),(5,4),(4,5),(1,6),(6,1),(6,1),(6,1),(9,8),(9,8),(9,8),(9,8),(10,11),(10,11),(10,11),(10,11),(2,3),(2,3),(2,3),
        # Second Stage % First Week
        (6,5),(6,5),(6,5),(5,6),(2,1),(2,1),(2,1),(1,2),(4,3),(4,3),(4,3),(4,3),(8,7),(7,8),(7,8),(7,8),(10,9),(10,9),(9,10),(9,10),(9,10),(12,11),(12,11),(12,11),(12,11),
        (11,8),(11,8),(11,8),(11,8),(4,6),(6,4),(6,4),(6,4),(5,2),(2,5),(2,5),(2,5),(7,9),(7,9),(7,9),(7,9),(12,10),(12,10),(12,10),(12,10),(1,3),(1,3),(1,3),(1,3),
        # Second Stage % Second Week
        (6,3),(6,3),(6,3),(3,6),(1,5),(1,5),(1,5),(4,2),(4,2),(4,2),(4,2),(9,6),(6,9),(6,9),(6,9),(2,10),(2,10),(2,10),(2,10),(11,3),(11,3),(11,3),(11,3),
        (7,11),(7,11),(7,11),(7,11),(12,9),(12,9),(12,9),(9,12),(8,10),(8,10),(10,8),(10,8),(10,8),(7,4),(4,7),(4,7),(4,7),(12,1),(12,1),(12,1),(12,1),(8,5),(8,5),(8,5),(5,8),(5,8),
        # Second Stage % Third Week
        (11,5),(11,5),(11,5),(11,5),(12,6),(6,12),(6,12),(12,6),(12,6),(9,3),(9,3),(9,3),(9,3),(12,3),(12,3),(12,3),(12,3),(8,2),(8,2),(2,8),(8,2),(10,4),(4,10),(4,10),(10,4),(4,10),
        (8,4),(4,8),(4,8),(7,1),(7,1),(7,1),(1,7),(2,11),(2,11),(11,2),(11,2),(7,6),(7,6),(7,6),(7,6),(1,10),(1,10),(1,10),(10,1),(9,5),(9,5),(9,5),(9,5),
        # Second Stage % Fourth Week
        (11,5),(11,5),(11,5),(11,5),(12,6),(6,12),(6,12),(12,6),(12,6),(9,3),(9,3),(9,3),(9,3),(12,3),(12,3),(12,3),(12,3),(8,2),(8,2),(2,8),(8,2),(10,4),(4,10),(4,10),(10,4),(4,10),
        (8,4),(4,8),(4,8),(7,1),(7,1),(7,1),(1,7),(2,11),(2,11),(11,2),(11,2),(7,6),(7,6),(7,6),(7,6),(1,10),(1,10),(1,10),(10,1),(9,5),(9,5),(9,5),(9,5),
        # Second Stage % Fifth Week
        (9,4),(9,4),(9,4),(4,9),(8,1),(8,1),(8,1),(1,8),(1,8),(10,3),(10,3),(10,3),(10,3),(10,6),(10,6),(10,6),(6,10),(12,5),(12,5),(12,5),(5,12),(5,12),(11,1),(11,1),(11,1),(1,11),(1,11),
        (8,6),(6,8),(6,8),(6,8),(2,9),(2,9),(9,2),(9,2),(9,2),(7,3),(7,3),(7,3),(7,3),(5,7),(7,5),(7,5),(7,5),(12,2),(12,2),(12,2),(12,2),(4,11),(4,11),(11,4),(11,4),(11,4),
        # Final Stage
        (9,7),(9,7),(9,7),(7,9),(7,9),(9,12),(9,12),(12,9),(12,9),(12,9)]

env = TrueSkill()
t1 = env.create_rating()
t2 = env.create_rating()
t3 = env.create_rating()
t4 = env.create_rating()
t5 = env.create_rating()
t6 = env.create_rating()
t7 = env.create_rating()
t8 = env.create_rating()
t9 = env.create_rating()
t10 = env.create_rating()
t11 = env.create_rating()
t12 = env.create_rating()

# Run algorithm
for contest in data:
    winner = contest[0]
    loser = contest[1]
    names['t%s' % winner],names['t%s' % loser] = rate_1vs1(names['t%s' % winner],names['t%s' % loser])

# Calculate win probability
import math
def win_prob(team_one, team_two):
    deltamu = team_one.mu - team_two.mu
    rsss = math.sqrt(team_one.sigma**2 + team_two.sigma**2)
    ts = global_env()
    return ts.cdf(deltamu/rsss)

# Rank the teams
teams = [t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12]
leaderboard = sorted(teams, key=env.expose, reverse=True)
name_of_leaderboard = []
for i in range(len(leaderboard)):
    for j in range(len(teams)):
        if leaderboard[i] == teams[j]: name_of_leaderboard.append(j+1)